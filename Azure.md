title: 使用国际版Azure搭建梯子教程
date: 2016-08-07 22:16:40
tags: Azure
categories: Azure
---
# 前言

本文基于MSDN订阅版本对应的[Azure云服务](https://portal.azure.com)提供的虚拟机服务，搭建自己的影子袜子（自己翻译成英文，懂的人都懂）。

过程中参考了众多软狗的相关文章，对此表示感谢。
<!--more-->
# 准备阶段

这部分介绍如何激活自己的Azure服务并配置自己的虚拟机。

首先用微软账号登录[Azure云服务](https://portal.azure.com)，注意与国内的Azure区别开来。然后选择新建->虚拟机->`Ubuntu Server 14.04 LTS`，部署类型选择资源管理器。

这一步结束之后，如果你之前已经激活了Azure服务，则跳过本段继续阅读。否则继续。在未激活Azure订阅时，上一步点击创建之后它会自动导航到“添加您的Azure订阅”的页面,选择Visual Studio Enterprise选项，点击了解更多，进到关于这项订阅的介绍页面，找到相关按钮然后点击激活Azure订阅。

此后，回到第一步，再新建一个虚拟机，镜像类型同样选择`Ubuntu Server 14.04 LTS`，就会弹出创建虚拟机的选项卡，基本配置中填写虚拟机的名字，用户名，密码（它默认是SSH公钥登录，你需要切换到密码登录的选项卡中），然后新建一个资源组。主机位置建议选择东亚（香港机房）或美国西部（加利福尼亚机房），虽然在铁通12M宽带环境下发现这俩的速度都差不多QAQ。点击确定以继续。

接下来，选择虚拟机套餐方案，A1足矣。

接下来就是虚拟机的配置部分。

磁盘类型选择标准。公共IP地址中注意选择静态IP（它默认给的是动态）。其他选项保持默认，点击确定.（有人提到在网络安全组当中要建一个入站规则允许所有网络连接，我在部署时未发现这个规则的必要性，所以暂且不表）。

进入第四步，确定相关信息没问题之后点击确定，开始部署。部署完成后，在概要中记下公共IP地址。

# 虚拟机安装影子袜子

本步骤需要ssh连接虚拟机。在*nix下用bash自带的ssh命令行即可。Windows平台下，可以使用cmder或者Xshell或者securCRT，putty之类的软件，我自己用的是Cygwin。

输入

	ssh [username]@[your IP]

回车之后，输入Yes，然后输入登录密码，登录到虚拟服务器。

> 注：方括号部分为根据自己的配置需要自行更改的部分。方括号里面已经标明字段含义。

登录成功后，输入

	sudo apt-get update

更新Ubuntu的软件列表，否则会导致后续软件安装失败。

然后，输入

	sudo apt-get install python-pip

安装pip软件管理程序。

输入

	sudo pip install shadowsocks

安装影子袜子。

输入

	sudo ssserver -p [port number] -k [password] -m aes-256-cfb --user nobody -d start
	
启动影子袜子的服务器端。

#客户端操作

至此，Azure部署影子袜子的服务器端部分已经完毕。接下来就是在需要梯子的地方，安装相关的客户端软件（貌似在水果手机上功能会受到很多限制）.

安装相关软件后，在设置页面，服务器地址，密码，端口，协议类型分别对应你的虚拟机IP地址，`[passport]`字段，`[port]`字段，以及 `aes-256-cfb`。点击连接，即可。


